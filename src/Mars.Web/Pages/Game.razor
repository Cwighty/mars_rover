@page "/game/{id}"
@using System.Collections.Concurrent
@inject MultiGameHoster multiGameHoster
@inject NavigationManager navManager

<CascadingValue Name="GameManager" Value="@GameManager">
    <div class="">
        <div class="row mt-2 mx-1 border-bottom">
            <h1 class="col">Mars Rover - 2023 Coding Challenge (Game '@Id')</h1>
            <div class="col-auto text-end">
                <div class="row">
                    <GameStatus />
                    <div class="float-end">
                        <a class="" href="/swagger/index.html">Swagger API Page</a>
                    </div>
                    <div class="float-end">
                        <NewGame />
                        <StartGame />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <BoardView />
</CascadingValue>

@code {
    [Parameter]
    public string? Id { get; set; }

    public GameManager? GameManager{ get; set; }

    protected override void OnParametersSet()
    {
        if (Id == null)
            return;

        if (multiGameHoster.Games.ContainsKey(Id))
        {
            GameManager = multiGameHoster.Games[Id];
        }
        else
        {
            navManager.NavigateTo("/");
        }
    }
}
